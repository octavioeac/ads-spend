{
  "info": {
    "name": "metrics-api",
    "_postman_id": "5e42f5d0-2d3d-4af8-8d13-123456789abc",
    "description": "Collection to test all metrics-api endpoints on Cloud Run",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Health",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "https://metrics-api-237577500123.us-central1.run.app/health",
          "protocol": "https",
          "host": [
            "metrics-api-237577500123",
            "us-central1",
            "run",
            "app"
          ],
          "path": ["health"]
        }
      }
    },
    {
      "name": "Root",
      "request": {
        "method": "GET",
        "url": {
          "raw": "https://metrics-api-237577500123.us-central1.run.app/",
          "protocol": "https",
          "host": [
            "metrics-api-237577500123",
            "us-central1",
            "run",
            "app"
          ],
          "path": [""]
        }
      }
    },
    {
      "name": "Compare Periods (Metrics)",
      "request": {
        "method": "GET",
        "url": {
          "raw": "https://metrics-api-237577500123.us-central1.run.app/metrics?first_start=2025-05-01&first_end=2025-05-31&second_start=2025-06-01&second_end=2025-06-30",
          "protocol": "https",
          "host": [
            "metrics-api-237577500123",
            "us-central1",
            "run",
            "app"
          ],
          "path": ["metrics"],
          "query": [
            {"key": "first_start", "value": "2025-05-01"},
            {"key": "first_end", "value": "2025-05-31"},
            {"key": "second_start", "value": "2025-06-01"},
            {"key": "second_end", "value": "2025-06-30"}
          ]
        }
      }
    },
    {
      "name": "NLQ Parse (execute=false)",
      "request": {
        "method": "POST",
        "header": [
          {"key": "Content-Type", "value": "application/json"}
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"question\": \"Compare CAC and ROAS for last 30 days vs prior 30 days\",\n  \"execute\": false\n}"
        },
        "url": {
          "raw": "https://metrics-api-237577500123.us-central1.run.app/nlq/parse",
          "protocol": "https",
          "host": [
            "metrics-api-237577500123",
            "us-central1",
            "run",
            "app"
          ],
          "path": ["nlq","parse"]
        }
      }
    },
    {
      "name": "NLQ Parse (execute=true)",
      "request": {
        "method": "POST",
        "header": [
          {"key": "Content-Type", "value": "application/json"}
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"question\": \"Compare spend for last 7 days vs previous 7 days\",\n  \"execute\": true\n}"
        },
        "url": {
          "raw": "https://metrics-api-237577500123.us-central1.run.app/nlq/parse",
          "protocol": "https",
          "host": [
            "metrics-api-237577500123",
            "us-central1",
            "run",
            "app"
          ],
          "path": ["nlq","parse"]
        }
      }
    },
    {
      "name": "Trigger n8n",
      "request": {
        "method": "GET",
        "url": {
          "raw": "https://metrics-api-237577500123.us-central1.run.app/trigger-n8n?insertId=test123&amount=100",
          "protocol": "https",
          "host": [
            "metrics-api-237577500123",
            "us-central1",
            "run",
            "app"
          ],
          "path": ["trigger-n8n"],
          "query": [
            {"key": "insertId", "value": "test123"},
            {"key": "amount", "value": "100"}
          ]
        }
      }
    },
    {
      "name": "Diagnostics - Token",
      "request": {
        "method": "GET",
        "url": {
          "raw": "https://metrics-api-237577500123.us-central1.run.app/_diag/token",
          "protocol": "https",
          "host": [
            "metrics-api-237577500123",
            "us-central1",
            "run",
            "app"
          ],
          "path": ["_diag","token"]
        }
      }
    },
    {
      "name": "Diagnostics - BigQuery",
      "request": {
        "method": "GET",
        "url": {
          "raw": "https://metrics-api-237577500123.us-central1.run.app/_diag/bq",
          "protocol": "https",
          "host": [
            "metrics-api-237577500123",
            "us-central1",
            "run",
            "app"
          ],
          "path": ["_diag","bq"]
        }
      }
    },
    {
      "name": "BigQuery - Table Exists",
      "request": {
        "method": "GET",
        "url": {
          "raw": "https://metrics-api-237577500123.us-central1.run.app/bq/exists",
          "protocol": "https",
          "host": [
            "metrics-api-237577500123",
            "us-central1",
            "run",
            "app"
          ],
          "path": ["bq","exists"]
        }
      }
    },
    {
      "name": "Available Months",
      "request": {
        "method": "GET",
        "url": {
          "raw": "https://metrics-api-237577500123.us-central1.run.app/metadata/months-available",
          "protocol": "https",
          "host": [
            "metrics-api-237577500123",
            "us-central1",
            "run",
            "app"
          ],
          "path": ["metadata","months-available"]
        }
      }
    }
  ]
}
